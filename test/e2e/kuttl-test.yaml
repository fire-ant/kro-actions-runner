apiVersion: kuttl.dev/v1beta1
kind: TestSuite
metadata:
  name: kro-actions-runner-e2e
# Global timeout for all tests (10 minutes)
timeout: 600
# Run tests sequentially to avoid conflicts
parallel: 1
# Don't delete resources after tests (useful for debugging)
# Set to true in CI or when tests are stable
skipDelete: false
# Start a kind cluster automatically
startKIND: true
# Cache kind node images for faster startup
kindNodeCache: true
# Kind cluster context name
kindContext: kro-test
# Kind cluster configuration
kindConfig: test/fixtures/kind/kind-config.yaml
# Default namespace for tests
namespace: arc-runners
# Commands to run before tests (setup cluster)
commands:
  - command: test/scripts/install-kro.sh
    ignoreFailure: false
  - command: test/scripts/install-arc.sh
    ignoreFailure: false
  - command: test/scripts/load-image.sh
    ignoreFailure: false
# Test directories to run (kar-integration first as primary test)
testDirs:
  - test/e2e/kar-integration/     # PRIMARY - Tests actual kar binary
  - test/e2e/pod-runner/
  - test/e2e/rgd-discovery/
  - test/e2e/rbac-validation/
