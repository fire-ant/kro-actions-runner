# ctlptl configuration for kind cluster with local registry
# This sets up a kind cluster with a local container registry for faster image loading
# Usage: ctlptl apply -f ctlptl-kind-config.yaml
apiVersion: ctlptl.dev/v1alpha1
kind: Registry
name: kro-test-registry
port: 5005
---
apiVersion: ctlptl.dev/v1alpha1
kind: Cluster
product: kind
name: kind-gha-arc-kro-runner
registry: kro-test-registry
kindV1Alpha4Cluster:
  nodes:
    - role: control-plane
      kubeadmConfigPatches:
        - |
          kind: InitConfiguration
          nodeRegistration:
            kubeletExtraArgs:
              node-labels: "ingress-ready=true"
      extraPortMappings:
        - containerPort: 80
          hostPort: 80
          protocol: TCP
        - containerPort: 443
          hostPort: 443
          protocol: TCP
        # LocalStack NodePort for external access
        - containerPort: 30566
          hostPort: 30566
          protocol: TCP
      extraMounts:
        # Mount Docker socket for LocalStack EC2 instance simulation
        - hostPath: /var/run/docker.sock
          containerPath: /var/run/docker.sock
